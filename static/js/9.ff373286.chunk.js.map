{"version":3,"sources":["components/GeoInput/index.js","components/PresetInput/index.js","components/DateInput/index.js","components/AudienceInput/Box.js","components/AudienceInput/Dustbin.js","components/AudienceInput/index.js","components/AddressInput/index.js","components/Questions/index.js"],"names":["GeoInput","props","state","lng","NaN","lat","countryCode","legalityStatusNumber","initialMapViewport","undefined","usedMarker","setStateGeoPos","bind","getStatusColor","window","addEventListener","this","marker","markerChanged","removeEventListener","setTimeout","globals","mainMapFunctions","useAsGeoChooser","alpha3code","ilga","getILGA","overview","statusNumber","graphql","query","query_countrycode","variables","then","result","data","countrycode","setState","getLegalityNumber","catch","error","center","zoom","getGeo","markerPos","newZoom","store","get","getMapType","flyTo","padding","left","sidebarIsOpen","duration","transitionDuration","unproject","project","add","doc","storeKey","map_center_fake","Array","isArray","Number","parseFloat","toFixed","event","setCountryCode","onChange","status","theme","palette","success","main","warning","background","default","style","Typography","variant","gutterBottom","Localized","id","opacity","vars","key","marginTop","color","display","margin","borderRadius","overflow","DiscriminationFacts","toggleable","React","Component","withGlobals","withTheme","PresetInput","filterOptions","options","inputValue","matchSorter","threshold","rankings","CONTAINS","keys","_options_","concat","categories","map","category","Object","values","_presets_","filter","preset","presets","some","presetKey","startsWith","preset4options","category_name_translated","getTranslation","name","userLocales","sort","presetSorter","getString","colors","presetChanged","a","b","icon_compare","icon","localeCompare","name_compare","name_translated","terms_translated","terms","toLowerCase","value","defaultValue","Autocomplete","groupBy","getOptionLabel","getOptionSelected","renderOption","ListItem","component","ListItemIcon","className","bg","fg","backgroundColor","width","height","lineHeight","textAlign","ListItemText","primary","ListboxProps","WebkitOverflowScrolling","PaperComponent","Paper","blurOnSelect","openOnFocus","clearText","closeText","noOptionsText","openText","renderInput","params","TextField","label","withLocalization","DateInput","year","month","date","formated","parseDateString","setValue","parts","match","hasOwnProperty","day","getFormatedValue","formatKey","real","isSet","asString","padStart","daysInMonth","Date","getDate","fromEntries","entries","entry","dateInputOrder","split","v","index","autoFocus","type","target","helperText","Box","onDelete","item","useDrag","collect","monitor","isDragging","drag","Chip","ref","cursor","Dustbin","accept","items","onDrop","onRemoveItem","useTheme","useDrop","drop","isOver","canDrop","isActive","hasItems","length","FormControl","fullWidth","transition","InputLabel","focused","shrink","minHeight","borderWidth","borderStyle","borderColor","secondary","fontSize","visibility","maxWidth","AudienceInput","DndProvider","backend","Backend","AudienceInputInner","useState","dustbins","setItems","useEffect","replace","handleDrop","useCallback","newItems","update","$set","changedItems","marginBottom","AddressInput","showAllFields","newValue","parseDefaultValue","toggleShowAllFields","JSON","parse","stringify","publishChanges","tags","convert_alpha3_to_alpha2","alpha2code","changedValues","addressFormat","widths","flexShrink","country","countryCodeLowerCase","getAddressFormatByCountryCode","format","row","title","size","getAddressInputStyles","FormControlLabel","boxShadow","divider","shape","control","Switch","checked","inputProps","Questions","questionsAreLoaded","answersByQuestionId","questionsById","nextQuestionIDs","stageIndex","sourcesText","answer_tags","tagsFromTheDoc","inputValues","renderStage","answerQuestion","loadQuestions","submitInputs","setQuestionAsActive","savePresetValue","saveValueByKey","abort","acceptPrivacyPolicy","showQuestions","addSources","suggest","finish","saveSourcesText","getPrivacy","startQuestions","properties","loadQuestionsQuerySubscription","unsubscribe","watchQuery","fetchPolicy","query_questions","languages","navigator","subscribe","firstOpenQuestionCounter","questions","reduce","obj","questionDoc","hasGeoInputField","possibleAnswers","possibleAnswer","inputtype","isSmallScreen","question_translated","getTranslationFromArray","question","in_one_word_translated","in_one_word","description_translated","description","answer","title_translated","_id","visible","active","answered","possibleAnswersByKey","questionID","questionIDs","answerKey","answerValue","question_doc","followUpQuestionIDs","questionGotAnswered","answer2tags","allKeys","includes","currentQuestionPos","indexOf","nextQuestionIDs_start_part","slice","nextQuestionIDs_end_part","Set","thisIndex","i","tmp_inputValues","namespace","toReturn","namespaceWithColon","namespaceWithColonLenght","substring","lenght","tagKeys","saveInputValue","hasInputField","isMultiRow","location","geometry","heading","elevation","onClick","dense","disableGutters","primaryTypographyProps","flexDirection","hidden","possibleAnswerKey","possibleAnswerNamespace","inputOptions","getInputValueByNamespace","getInputValue","multiline","button","flexGrow","border","justifyContent","minWidth","alignSelf","Button","marginRight","onAbort","setPrivacy","finally","set","uuidv4","mutate","mutation","mutation_addChangeset","forID","sources","fromBot","dataset","antiSpamUserIdentifier","console","onFinish","elems","privacy_policy_link","Link","href","Fab","marginLeft","Fragment","renderQuestion","placeholder"],"mappings":"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","file":"static/js/9.ff373286.chunk.js","sourcesContent":["import React from 'react'\n// import './index.css'\n\nimport {\n\tcountrycode as query_countrycode,\n} from '../../queries.js'\n\nimport {\n\tTypography,\n} from '@material-ui/core'\n// import {\n// \tAddRounded as AddIcon,\n// } from '@material-ui/icons'\n\nimport { Localized/*, withLocalization*/ } from '../Localized/'\nimport { withGlobals } from '../Globals/'\nimport { withTheme } from '@material-ui/core/styles'\nimport { getILGA } from '../../functions.js'\n\nimport DiscriminationFacts from '../DiscriminationFacts/'\n\nclass GeoInput extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tlng: NaN,\n\t\t\tlat: NaN,\n\t\t\tcountryCode: null,\n\t\t\tlegalityStatusNumber: null,\n\t\t}\n\n\t\tthis.initialMapViewport = undefined\n\t\tthis.usedMarker = undefined\n\n\t\tthis.setStateGeoPos = this.setStateGeoPos.bind(this)\n\t\tthis.getStatusColor = this.getStatusColor.bind(this)\n\t}\n\n\tcomponentDidMount(){\n\t\twindow.addEventListener('mapViewportUpdated', this.setStateGeoPos)\n\n\t\tif (this.usedMarker !== this.props.marker) {\n\t\t\tthis.markerChanged(this.props.marker)\n\t\t}\n\t}\n\tcomponentDidChange(){\n\t\tif (this.usedMarker !== this.props.marker) {\n\t\t\tthis.markerChanged(this.props.marker)\n\t\t}\n\t}\n\tcomponentWillUnmount(){\n\t\twindow.removeEventListener('mapViewportUpdated', this.setStateGeoPos)\n\t\tsetTimeout(()=>{\n\t\t\tthis.props.globals.mainMapFunctions.useAsGeoChooser(false, undefined)\n\t\t}, 1)\n\t}\n\n\tgetLegalityNumber(alpha3code){\n\t\tconst ilga = getILGA(alpha3code)\n\t\tif (ilga) {\n\t\t\treturn ilga.overview.statusNumber\n\t\t}\n\n\t\treturn null\n\t}\n\n\tsetCountryCode(lng, lat){\n\t\tthis.props.globals.graphql.query({\n\t\t\tquery: query_countrycode,\n\t\t\tvariables: {\n\t\t\t\tlng,\n\t\t\t\tlat,\n\t\t\t},\n\t\t}).then(result => {\n\t\t\tif (result && result.data && result.data.countrycode) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcountryCode: result.data.countrycode,\n\t\t\t\t\tlegalityStatusNumber: this.getLegalityNumber(result.data.countrycode),\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tthis.setState({\n\t\t\t\t\tcountryCode: null,\n\t\t\t\t\tlegalityStatusNumber: null,\n\t\t\t\t})\n\t\t\t}\n\t\t}).catch(error=>{\n\t\t\tthis.setState({\n\t\t\t\tcountryCode: null,\n\t\t\t\tlegalityStatusNumber: null,\n\t\t\t})\n\t\t})\n\t}\n\n\tmarkerChanged(marker){\n\t\tif (\n\t\t\tmarker && \n\t\t\tmarker.center &&\n\t\t\tmarker.zoom\n\t\t) {\n\t\t\tthis.usedMarker = marker\n\n\t\t\tlet lat = marker.center.lat || 0\n\t\t\tlet lng = marker.center.lng || 0\n\n\t\t\tif (lat === 0 && lng === 0) {\n\t\t\t\t({lng, lat} = this.getGeo())\n\t\t\t}\n\n\t\t\tlet markerPos = {lng,lat}\n\t\t\tlet newZoom = this.props.store.get('map_zoom') || 3\n\n\t\t\tif (this.props.globals.mainMapFunctions.getMapType() === 'mapbox') {\n\t\t\t\tthis.props.globals.mainMapFunctions.flyTo({\n\t\t\t\t\tcenter: markerPos,\n\t\t\t\t\tzoom: newZoom,\n\t\t\t\t\tpadding: {\n\t\t\t\t\t\tleft: (this.props.globals.sidebarIsOpen ? 400 : 0),\n\t\t\t\t\t},\n\t\t\t\t\tduration: this.props.globals.transitionDuration,\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tif (this.props.globals.sidebarIsOpen) { // TODO this.props.globals.sidebarIsOpen isn't enough on small screens\n\t\t\t\t\tmarkerPos = this.props.globals.mainMapFunctions.unproject(this.props.globals.mainMapFunctions.project(markerPos, newZoom).add([-200,0]), newZoom) // map center with sidebar offset\n\t\t\t\t}\n\t\t\t\tthis.props.globals.mainMapFunctions.flyTo(markerPos, newZoom, {\n\t\t\t\t\tduration: this.props.globals.transitionDuration * 0.001,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tsetTimeout(()=>{\n\t\t\t\tthis.props.globals.mainMapFunctions.useAsGeoChooser(true, this.props.doc)\n\t\t\t}, this.props.globals.transitionDuration)\n\t\t}\n\t}\n\n\tgetGeo(storeKey){\n\t\tconst map_center_fake = this.props.store.get('map_center_fake')\n\n\t\tlet lng = 0\n\t\tlet lat = 0\n\n\t\tif (Array.isArray(map_center_fake)) {\n\t\t\tlng = Number.parseFloat(map_center_fake[0].toFixed(6)) // WHY: just 6 decimal points: https://gis.stackexchange.com/questions/8650/measuring-accuracy-of-latitude-and-longitude\n\t\t\tlat = Number.parseFloat(map_center_fake[1].toFixed(6))\n\t\t} else if (!!map_center_fake) {\n\t\t\tlng = Number.parseFloat(map_center_fake.lng.toFixed(6))\n\t\t\tlat = Number.parseFloat(map_center_fake.lat.toFixed(6))\n\t\t}\n\n\t\treturn {lng, lat}\n\t}\n\n\tsetStateGeoPos(event){\n\t\tconst {lng,lat} = this.getGeo()\n\n\t\tthis.setState({lng,lat})\n\t\tthis.setCountryCode(lng, lat)\n\t\n\t\tif (this.props.onChange) {\n\t\t\tthis.props.onChange({\n\t\t\t\tlng,\n\t\t\t\tlat,\n\t\t\t})\n\t\t}\n\t}\n\n\tgetStatusColor(status){\n\t\tif (status === 'great' || status === 1) {\n\t\t\treturn this.props.theme.palette.success.main\n\t\t} else if (status === 'ok' || status === 2) {\n\t\t\treturn this.props.theme.palette.warning.main\n\t\t} else if (status === 'bad' || status === 3) {\n\t\t\treturn this.props.theme.palette.error.main\n\t\t}\n\t\treturn this.props.theme.palette.background.default\n\t}\n\n\trender() {\n\t\treturn (<div style={this.props.style}>\n\t\t\t<Typography variant=\"body2\" gutterBottom>\n\t\t\t\t<Localized id=\"instructions\" />\n\t\t\t</Typography>\n\t\t\t<Typography variant=\"body2\" style={{opacity:0.6}}>\n\t\t\t\t<Localized id=\"lat\" vars={{ lat: (this.state.lat+'' || '') }} />\n\t\t\t</Typography>\n\t\t\t<Typography variant=\"body2\" style={{opacity:0.6}}>\n\t\t\t\t<Localized id=\"lng\" vars={{ lng: (this.state.lng+'' || '') }} />\n\t\t\t</Typography>\n\n\t\t\t{\n\t\t\t\tthis.state.legalityStatusNumber === 3\n\t\t\t\t? (\n\t\t\t\t\t<Typography\n\t\t\t\t\t\tkey=\"geoInputErrorMessage_NotLegal\"\n\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tmarginTop: '16px',\n\t\t\t\t\t\t\tcolor: this.getStatusColor(this.state.legalityStatusNumber),\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Localized id=\"legality_message_geo_not_legal\" />\n\t\t\t\t\t</Typography>\n\t\t\t\t)\n\t\t\t\t: undefined\n\t\t\t}\n\n\t\t\t<Typography\n\t\t\t\tkey=\"geoInputInfoMessage_BeCautious\"\n\t\t\t\tvariant=\"body2\"\n\t\t\t\tstyle={{\n\t\t\t\t\tmarginTop: '16px',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Localized id=\"legality_message_be_cautious\" />\n\t\t\t</Typography>\n\n\t\t\t{\n\t\t\t\t!!this.state.countryCode\n\t\t\t\t? (\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\tmargin: '16px 0 0',\n\t\t\t\t\t\t\tbackground: this.props.theme.palette.background.default,\n\t\t\t\t\t\t\tborderRadius: '8px',\n\t\t\t\t\t\t\t// border: '1px solid '+this.props.theme.palette.divider,\n\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DiscriminationFacts\n\t\t\t\t\t\t\tkey={'d_facts_'+this.state.countryCode}\n\t\t\t\t\t\t\tcountryCode={this.state.countryCode}\n\t\t\t\t\t\t\ttoggleable={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t\t: undefined\n\t\t\t}\n\t\t</div>)\n\t}\n}\n\nexport default withGlobals(withTheme(GeoInput))\n\n// You can't use this position as it's illegal to be queer there. (Or we aren't sure.)\n\n/*\n\n- klick \"add a place\"\n- hide all icon and all UI\n- add a new icon in the middle of the screen (it stays in the middle even when the map is moved)\n- the icon should be an input field for lat+lng\n- add a submit-button and a heading \"Where is the place located?\"\n\n*/","import React from 'react'\n// import './index.css'\n\nimport {\n\tPaper,\n\tTextField,\n\n\tListItem,\n\tListItemIcon,\n\tListItemText,\n} from '@material-ui/core'\nimport Autocomplete from '@material-ui/lab/Autocomplete'\nimport matchSorter from 'match-sorter'\n\nimport { withLocalization } from '../Localized/'\nimport { withGlobals } from '../Globals/'\n\nimport { getTranslation } from '../../functions.js'\n\nimport categories from '../../data/dist/categories.json'\nimport _presets_ from '../../data/dist/presets.json'\nimport colors from '../../data/dist/colors.json'\n\n\n\nclass PresetInput extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.filterOptions = (options, {inputValue}) => matchSorter(options, inputValue, {\n\t\t\tthreshold: matchSorter.rankings.CONTAINS,\n\t\t\tkeys: ['name_translated' ,'terms_translated','category_name_translated','key','color.key']\n\t\t})\n\n\t\tthis._options_ = [].concat(\n\t\t\t...(\n\t\t\t\tcategories\n\t\t\t\t.map(category =>\n\t\t\t\t\tObject.values(_presets_)\n\t\t\t\t\t.filter(preset => category.presets.some(\n\t\t\t\t\t\tpresetKey => preset.key === presetKey || preset.key.startsWith(presetKey+'/')\n\t\t\t\t\t))\n\t\t\t\t\t.map(preset => this.preset4options({\n\t\t\t\t\t\t...preset,\n\t\t\t\t\t\tcategory_name_translated: getTranslation(category.name, this.props.globals.userLocales),\n\t\t\t\t\t\tcolor: category.color,\n\t\t\t\t\t}))\n\t\t\t\t\t.sort(this.presetSorter)\n\t\t\t\t)\n\t\t\t),\n\t\t\t...(\n\t\t\t\tObject.values(_presets_)\n\t\t\t\t.filter(preset => !categories.some(\n\t\t\t\t\tcategory => category.presets.some(\n\t\t\t\t\t\tpresetKey => (\n\t\t\t\t\t\t\tpreset.key === presetKey\n\t\t\t\t\t\t\t|| preset.key.startsWith(presetKey+'/')\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t))\n\t\t\t\t.map(preset => this.preset4options({\n\t\t\t\t\t...preset,\n\t\t\t\t\tcategory_name_translated: props.getString('category_more'),\n\t\t\t\t\tcolor: colors.default,\n\t\t\t\t}))\n\t\t\t\t.sort(this.presetSorter)\n\t\t\t)\n\t\t)\n\n\t\tthis.presetChanged = this.presetChanged.bind(this)\n\t}\n\n\n\tpresetSorter(a, b){\n\t\tconst icon_compare = b.icon.localeCompare(a.icon)\n\t\tconst name_compare = -b.name_translated.localeCompare(a.name_translated)\n\t\treturn icon_compare === 0 ? name_compare : icon_compare\n\t}\n\n\tpreset4options(preset){\n\t\treturn {\n\t\t\t...preset,\n\t\t\tname_translated: getTranslation(preset.name, this.props.globals.userLocales),\n\t\t\tterms_translated: getTranslation(preset.terms, this.props.globals.userLocales),\n\t\t\ticon: preset.icon ? preset.icon.toLowerCase() : '',\n\t\t}\n\t}\n\n\tpresetChanged(event, value){\n\t\tif (this.props.onChange) {\n\t\t\tthis.props.onChange(value && value.key ? value.key : null)\n\t\t}\n\t}\n\n\trender() {\n\n\t\tlet defaultValue = undefined\n\t\tif (this.props.defaultValue && _presets_[this.props.defaultValue]) {\n\t\t\tdefaultValue = this.preset4options({\n\t\t\t\t..._presets_[this.props.defaultValue],\n\t\t\t\tcategory_name_translated: '', // isn't really needed\n\t\t\t\tcolor: colors.default, // isn't really needed\n\t\t\t})\n\t\t}\n\n\t\treturn (<div style={this.props.style}>\n\t\t\t<Autocomplete\n\t\t\t\toptions={this._options_}\n\t\t\t\tgroupBy={preset => preset.category_name_translated || ''}\n\t\t\t\tgetOptionLabel={preset => preset.name_translated}\n\t\t\t\tgetOptionSelected={(preset, value) => !!value && value.key === preset.key}\n\t\t\t\n\t\t\t\trenderOption={(preset) => (<ListItem\n\t\t\t\t\tcomponent=\"div\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmargin: '-6px -16px -6px -24px',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"material-icons-round\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tcolor: (\n\t\t\t\t\t\t\t\t\tpreset.icon\n\t\t\t\t\t\t\t\t\t? (\n\t\t\t\t\t\t\t\t\t\tpreset.color.key === 'default'\n\t\t\t\t\t\t\t\t\t\t? preset.color.bg\n\t\t\t\t\t\t\t\t\t\t: preset.color.fg\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tbackgroundColor: (\n\t\t\t\t\t\t\t\t\tpreset.icon\n\t\t\t\t\t\t\t\t\t? (\n\t\t\t\t\t\t\t\t\t\tpreset.color.key === 'default'\n\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t: preset.color.bg\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\t\t\t\twidth: '40px',\n\t\t\t\t\t\t\t\theight: '40px',\n\t\t\t\t\t\t\t\tlineHeight: '40px',\n\t\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>{preset.icon}</div>\n\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t<ListItemText primary={preset.name_translated}/>\n\t\t\t\t</ListItem>)}\n\n\t\t\t\tListboxProps={{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tWebkitOverflowScrolling: 'touch',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t\tPaperComponent={Paper}\n\t\t\t\t\n\t\t\t\tblurOnSelect\n\t\t\t\topenOnFocus\n\t\t\t\n\t\t\t\tclearText=\"nextQuestionIDs\"\n\t\t\t\tcloseText=\"Close\"\n\t\t\t\tnoOptionsText=\"No options\"\n\t\t\t\topenText=\"Open\"\n\t\t\t\n\t\t\t\tfilterOptions={this.filterOptions}\n\t\t\t\tdefaultValue={defaultValue}\n\t\t\t\tonChange={this.presetChanged}\n\t\t\t\n\t\t\t\trenderInput={(params) => (<TextField\n\t\t\t\t\t{...params}\n\t\t\t\n\t\t\t\t\tlabel={this.props.label || ''}\n\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t/>)}\n\t\t\t/>\n\t\t</div>)\n\t}\n}\n\nexport default withGlobals(withLocalization(PresetInput))\n\n\n\n","import React from 'react'\nimport './index.css'\n\nimport {\n\tTextField,\n\tTypography,\n} from '@material-ui/core'\n// import {\n// \tAddRounded as AddIcon,\n// } from '@material-ui/icons'\n\nimport { withLocalization } from '../Localized/'\nimport { withGlobals } from '../Globals/'\n\nclass DateInput extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tyear: '',\n\t\t\tmonth: '',\n\t\t\tdate: '',\n\t\t}\n\n\t\tthis.formated = {\n\t\t\tyear: null,\n\t\t\tmonth: null,\n\t\t\tdate: null,\n\t\t}\n\n\t\tthis.parseDateString = this.parseDateString.bind(this)\n\t\tthis.setValue = this.setValue.bind(this)\n\t}\n\n\tcomponentDidMount(){\n\t\tthis.parseDateString()\n\t}\n\tcomponentDidChange(){\n\t\tthis.parseDateString()\n\t}\n\tparseDateString(){\n\t\tconst defaultValue = this.props.defaultValue\n\n\t\tlet parts = []\n\t\tif (!!defaultValue) {\n\t\t\tif (!!defaultValue['']) {\n\t\t\t\tparts = defaultValue[''].match(/(\\d{4})(?:-(\\d{2})(?:-(\\d{2}))?)?/)\n\t\t\t} else if (typeof defaultValue === 'string') {\n\t\t\t\tparts = defaultValue.match(/(\\d{4})(?:-(\\d{2})(?:-(\\d{2}))?)?/)\n\t\t\t}\n\t\t}\n\n\t\tlet year = ''\n\t\tif (\n\t\t\t!(\n\t\t\t\tdefaultValue.hasOwnProperty('year:is_set') &&\n\t\t\t\tdefaultValue['year:is_set'] === false\n\t\t\t)\n\t\t\t&& (defaultValue['year'] || parts[1])\n\t\t) {\n\t\t\tyear = (defaultValue['year'] || parts[1])\n\t\t}\n\n\t\tlet month = ''\n\t\tif (\n\t\t\t!(\n\t\t\t\tdefaultValue.hasOwnProperty('month:is_set') &&\n\t\t\t\tdefaultValue['month:is_set'] === false\n\t\t\t)\n\t\t\t&& (defaultValue['month'] || parts[2])\n\t\t) {\n\t\t\tmonth = (defaultValue['month'] || parts[2])\n\t\t}\n\n\t\tlet day = ''\n\t\tif (\n\t\t\t!(\n\t\t\t\tdefaultValue.hasOwnProperty('day:is_set') &&\n\t\t\t\tdefaultValue['day:is_set'] === false\n\t\t\t)\n\t\t\t&& (defaultValue['day'] || parts[3])\n\t\t) {\n\t\t\tday = (defaultValue['day'] || parts[3])\n\t\t}\n\n\t\tthis.setState({year, month, day}, ()=>{\n\t\t\tthis.formated = {\n\t\t\t\tyear: this.getFormatedValue('year', year),\n\t\t\t\tmonth: this.getFormatedValue('month', month),\n\t\t\t\tday: this.getFormatedValue('day', day),\n\t\t\t}\n\t\t})\n\t}\n\n\tgetFormatedValue(formatKey,value){\n\t\tconst real = value\n\t\tlet isSet = false\n\t\tlet asString = ''\n\t\tvalue *= 1\n\n\t\tif (formatKey === 'year') {\n\t\t\tif (value > 99999) {\n\t\t\t\tvalue = 99999\n\t\t\t} else {\n\t\t\t\tisSet = true\n\t\t\t}\n\t\t\tasString = (value+'').padStart(4,'0')\n\t\t} else if (formatKey === 'month') {\n\t\t\tif (value > 12) {\n\t\t\t\tvalue = 12\n\t\t\t} else if (value < 1) {\n\t\t\t\tvalue = 1\n\t\t\t} else {\n\t\t\t\tisSet = true\n\t\t\t}\n\t\t\tasString = (value+'').padStart(2,'0')\n\t\t} else if (formatKey === 'day') {\n\t\t\tlet daysInMonth = 31\n\t\t\tif (\n\t\t\t\tthis.formated.year &&\n\t\t\t\tthis.formated.year.isSet &&\n\t\t\t\tthis.formated.month &&\n\t\t\t\tthis.formated.month.isSet\n\t\t\t) {\n\t\t\t\tdaysInMonth = new Date(this.formated.year.value, this.formated.month.value, 0).getDate()\n\t\t\t}\n\n\t\t\tif (value > daysInMonth) {\n\t\t\t\tvalue = daysInMonth\n\t\t\t} else if (value < 1) {\n\t\t\t\tvalue = 1\n\t\t\t} else {\n\t\t\t\tisSet = true\n\t\t\t}\n\t\t\tasString = (value+'').padStart(2,'0')\n\t\t}\n\n\t\treturn {\n\t\t\tasString,\n\t\t\tvalue,\n\t\t\tisSet,\n\t\t\treal,\n\t\t}\n\t}\n\n\tsetValue(formatKey,value){\n\t\tthis.formated[formatKey] = this.getFormatedValue(formatKey,value)\n\t\tif (formatKey !== 'day') {\n\t\t\tthis.formated.day = this.getFormatedValue('day',this.formated.day.real)\n\t\t}\n\n\t\tconst values = Object.fromEntries(Object.entries(this.formated).map(entry => [\n\t\t\tentry[0],\n\t\t\tentry[1].value,\n\t\t]))\n\t\tconst isSet = Object.fromEntries(Object.entries(this.formated).map(entry => [\n\t\t\tentry[0]+':is_set',\n\t\t\tentry[1].isSet,\n\t\t]))\n\n\t\tif (this.props.onChange) {\n\t\t\tthis.props.onChange({\n\t\t\t\t'': this.formated.year.asString+'-'+this.formated.month.asString+'-'+this.formated.day.asString,\n\t\t\t\t...values,\n\t\t\t\t...isSet,\n\t\t\t})\n\t\t}\n\t}\n\n\trender() {\n\t\tconst dateInputOrder = this.props.getString('date-input-order', null, '').split('-').filter(v=>!!v && v !== ' ') // year-month-day\n\n\t\treturn (<div\n\t\t\tclassName=\"DateInput\"\n\t\t\tstyle={this.props.style}\n\t\t>\n\t\t\t<div className=\"TextFields\">\n\t\t\t\t{\n\t\t\t\t\tdateInputOrder.map((formatKey,index) => (<TextField\n\t\t\t\t\t\tautoFocus={formatKey === 'year'}\n\t\t\t\t\t\tclassName=\"TextField\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tkey={formatKey+'_'+this.state[formatKey]}\n\t\t\t\t\t\tlabel={this.props.getString(`${formatKey}-label`, null, formatKey)}\n\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\tdefaultValue={this.state[formatKey]}\n\t\t\t\t\t\tonChange={event => this.setValue(formatKey,event.target.value)}\n\t\t\t\t\t/>))\n\t\t\t\t}\n\t\t\t</div>\n\n\t\t\t{\n\t\t\t\t!!this.props.helperText\n\t\t\t\t? <Typography className=\"helperText\" variant=\"caption\">{this.props.helperText}</Typography>\n\t\t\t\t: null\n\t\t\t}\n\t\t</div>)\n\t}\n}\n\nexport default withGlobals(withLocalization(DateInput))\n\n\n","import React from 'react'\nimport { useDrag } from 'react-dnd'\n\nimport {\n\tChip,\n} from '@material-ui/core'\n\nconst Box = ({ index, type, label, onDelete }) => {\n\tconst item = { index, type }\n\n\tconst [{ isDragging }, drag] = useDrag({\n\t\titem,\n\t\tcollect: monitor => ({\n\t\t\tisDragging: monitor.isDragging(),\n\t\t})\n\t})\n\n\treturn (\n\t\t<Chip\n\t\t\tref={drag}\n\t\t\tlabel={label}\n\t\t\tstyle={{\n\t\t\t\tcursor: 'move',\n\t\t\t\tmargin: '0 2px 4px 2px',\n\t\t\t\t'WebkitTouchCallout': 'none',\n\t\t\t\t  'WebkitUserSelect': 'none',\n\t\t\t\t   'KhtmlUserSelect': 'none',\n\t\t\t\t     'MozUserSelect': 'none',\n\t\t\t\t      'MsUserSelect': 'none',\n\t\t\t\t        'userSelect': 'none',\n\t\t\t\topacity: isDragging ? 0.4 : 1,\n\t\t\t}}\n\t\t\tonDelete={\n\t\t\t\ttypeof onDelete === 'function'\n\t\t\t\t? () => onDelete(item)\n\t\t\t\t: null\n\t\t\t}\n\t\t/>\n\t)\n}\nexport default Box\n","import React from 'react'\n\nimport { useTheme } from '@material-ui/core/styles'\n\nimport { useDrop } from 'react-dnd'\nimport Box from './Box.js'\n\nimport {\n\tFormControl,\n\tInputLabel,\n} from '@material-ui/core'\n\nconst Dustbin = ({ label, accept, items, onDrop, onRemoveItem }) => {\n\tconst theme = useTheme()\n\n\tconst [{ isOver, canDrop }, drop] = useDrop({\n\t\taccept,\n\t\tdrop: onDrop,\n\t\tcollect: monitor => ({\n\t\t\tisOver: monitor.isOver(),\n\t\t\tcanDrop: monitor.canDrop()\n\t\t})\n\t})\n\n\tconst isActive = isOver && canDrop\n\tconst hasItems = items.length > 0\n\tconst activeHelperText = '' // (isActive ? ' — Release to drop' : '')\n\n\treturn (\n\t\t<FormControl\n\t\t\tref={drop}\n\t\t\tvariant=\"outlined\"\n\t\t\tcolor=\"secondary\"\n\t\t\tfullWidth\n\t\t\tstyle={{\n\t\t\t\ttransition: 'margin-top 0.2s ease',\n\t\t\t\tmarginTop: (hasItems ? '16px' : '8px'),\n\t\t\t}}\n\t\t>\n\t\t\t<InputLabel focused={hasItems && isActive} shrink={hasItems}>\n\t\t\t\t{label}{activeHelperText}\n\t\t\t</InputLabel>\n\t\t<fieldset\n\t\t\tstyle={{\n\t\t\t\tdisplay: 'block',\n\t\t\t\twidth: 'auto',\n\t\t\t\tminHeight: '1.1875em',\n\t\t\t\tpadding: '18.5px 8px',\n\t\t\t\tborderWidth: '1px',\n\t\t\t\tborderStyle: 'solid',\n\t\t\t\tborderColor: (\n\t\t\t\t\tisActive\n\t\t\t\t\t? theme.palette.secondary.main\n\t\t\t\t\t: (\n\t\t\t\t\t\ttheme.palette.type === 'dark'\n\t\t\t\t\t\t? 'rgba(255,255,255,0.23)'\n\t\t\t\t\t\t: 'rgba(0,0,0,0.23)'\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t\ttransition: 'border-color 200ms ease 0ms',\n\t\t\t\tborderRadius: '8px',\n\t\t\t\tmarginTop: '-5px',\n\t\t\t}}\n\t\t>\n\t\t\t<legend\n\t\t\t\tstyle={{\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t\theight: '11px',\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tpadding: '0',\n\t\t\t\t\tfontSize: '0.75em',\n\t\t\t\t\ttextAlign: 'left',\n\t\t\t\t\tvisibility: 'hidden',\n\n\t\t\t\t\t...(\n\t\t\t\t\t\thasItems\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\tmaxWidth: '1000px',\n\t\t\t\t\t\t\ttransition: 'max-width 100ms ease 50ms',\n\t\t\t\t\t\t}\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\tmaxWidth: '0.01px',\n\t\t\t\t\t\t\ttransition: 'max-width 50ms ease 0ms',\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span style={{padding: '0 5px'}}>{label}{activeHelperText}</span>\n\t\t\t</legend>\n\n\t\t\t<div style={{margin: '-13px -2px -14px -2px'}}>\n\t\t\t\t{items.map(item => (\n\t\t\t\t\t<Box\n\t\t\t\t\t\tkey={item.index}\n\t\t\t\t\t\tindex={item.index}\n\t\t\t\t\t\tlabel={item.label}\n\t\t\t\t\t\ttype={item.type}\n\t\t\t\t\t\tonDelete={onRemoveItem}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</fieldset>\n\t\t</FormControl>\n\t)\n}\nexport default Dustbin\n\n\t\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport { DndProvider } from 'react-dnd'\nimport Backend from 'react-dnd-html5-backend'\nimport update from 'immutability-helper'\n\nimport Dustbin from './Dustbin.js'\nimport Box from './Box.js'\n\nimport {\n\tTypography,\n} from '@material-ui/core'\n\nimport Localized from '../Localized/'\n\nconst AudienceInput = (props) => {\n\treturn (\n\t\t<DndProvider backend={Backend}>\n\t\t\t<AudienceInputInner {...props} />\n\t\t</DndProvider>\n\t)\n}\n\nexport default AudienceInput\n\n\n\n\n\n////////////////////////////////////////////////////////////////\n\n\n\n\n\nconst accept_type = 'box'\n\nconst AudienceInputInner =  ({ defaultValue, onChange, style }) => {\n\tconst [dustbins] = useState([\n\t\t{ value: 'only', label: <Localized id=\"audience_input_label_only\" /> },\n\t\t{ value: 'primary', label: <Localized id=\"audience_input_label_primary\" /> },\n\t\t{ value: 'welcome', label: <Localized id=\"audience_input_label_welcome\" /> },\n\t\t{ value: 'no', label: <Localized id=\"audience_input_label_no\" /> }\n\t])\n\tconst [items, setItems] = useState([])\n\n\tuseEffect(()=>{\n\t\tsetItems(\n\t\t\t[\n\t\t\t\t'queer',\n\t\t\t\t'youth',\n\t\t\t\t'trans',\n\t\t\t\t'inter',\n\t\t\t\t'sexuality:bi',\n\t\t\t\t'sexuality:lesbian',\n\t\t\t\t'sexuality:gay',\n\t\t\t\t'allies',\n\t\t\t\t'cis',\n\t\t\t\t'men',\n\t\t\t\t'women',\n\t\t\t]\n\t\t\t.map(key => ({\n\t\t\t\tkey: key,\n\t\t\t\tlabel: <Localized id={key.replace(/:/g, '_')} />,\n\t\t\t\tvalue: defaultValue[key] || null,\n\t\t\t\tdefaultValue: defaultValue[key] || null,\n\t\t\t\ttype: accept_type,\n\t\t\t}))\n\t\t)\n\t}, [defaultValue])\n\n\tconst handleDrop = useCallback(\n\t\t(value, item) => {\n\t\t\tconst newItems = update(items, {\n\t\t\t\t[item.index]: {\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\t$set: value\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tsetItems(newItems)\n\n\t\t\tconst changedItems = Object.fromEntries(\n\t\t\t\tnewItems\n\t\t\t\t.filter(item => item.hasOwnProperty('value') && item.value !== item.defaultValue)\n\t\t\t\t.map(item => [item.key, item.value || false])\n\t\t\t)\n\n\t\t\tonChange(changedItems)\n\t\t},\n\t\t[items, onChange]\n\t)\n\n\treturn (\n\t\t<div style={style}>\n\t\t\t<Typography variant=\"body2\" style={{marginBottom: '16px'}}>\n\t\t\t\t<Localized id=\"audience_input_instruction\" />\n\t\t\t</Typography>\n\t\t\t\n\t\t\t<div>\n\t\t\t\t{items\n\t\t\t\t\t.map((item, index) => ({ ...item, index }))\n\t\t\t\t\t.filter(item => item.value === null)\n\t\t\t\t\t.map(item => (\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tkey={item.index}\n\t\t\t\t\t\t\tindex={item.index}\n\t\t\t\t\t\t\tlabel={item.label}\n\t\t\t\t\t\t\ttype={item.type}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t</div>\n\n\t\t\t{dustbins.map(({ value, label }) => (\n\t\t\t\t<Dustbin\n\t\t\t\t\tkey={value}\n\t\t\t\t\tlabel={label}\n\t\t\t\t\taccept={[accept_type]}\n\t\t\t\t\titems={items\n\t\t\t\t\t\t.map((item, index) => ({ ...item, index }))\n\t\t\t\t\t\t.filter(item => item.value === value)}\n\t\t\t\t\tonDrop={item => handleDrop(value, item)}\n\t\t\t\t\tonRemoveItem={item => handleDrop(null, item)}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</div>\n\t)\n}","import React from 'react'\nimport './index.css'\n\nimport {\n\tcountrycode as query_countrycode,\n} from '../../queries.js'\n\nimport {\n\tTextField,\n\tTypography,\n\tFormControlLabel,\n\tSwitch,\n} from '@material-ui/core'\n// import {\n// \tAddRounded as AddIcon,\n// } from '@material-ui/icons'\n\nimport { withLocalization } from '../Localized/'\nimport { withGlobals } from '../Globals/'\nimport { withTheme } from '@material-ui/core/styles'\nimport { getAddressFormatByCountryCode } from '../../functions.js'\n\nclass AddressInput extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tvalue: {},\n\t\t\tshowAllFields: false,\n\t\t}\n\n\t\tthis.newValue = {}\n\n\t\tthis.parseDefaultValue = this.parseDefaultValue.bind(this)\n\t\tthis.setValue = this.setValue.bind(this)\n\t\tthis.toggleShowAllFields = this.toggleShowAllFields.bind(this)\n\t}\n\n\tcomponentDidMount(){\n\t\tthis.parseDefaultValue()\n\t}\n\tcomponentDidChange(){\n\t\tthis.parseDefaultValue()\n\t}\n\tparseDefaultValue(){\n\t\tthis.setState({\n\t\t\tvalue: this.props.defaultValue || {}\n\t\t}, ()=>{\n\t\t\tthis.newValue = JSON.parse(JSON.stringify(this.state.value))\n\t\t\tthis.publishChanges()\n\n\t\t\tthis.setCountryCode()\n\t\t})\n\t}\n\n\tsetCountryCode(){\n\t\tconst lng = this.props.tags.lng\n\t\tconst lat = this.props.tags.lat\n\n\t\tthis.props.globals.graphql.query({\n\t\t\tquery: query_countrycode,\n\t\t\tvariables: {\n\t\t\t\tlng,\n\t\t\t\tlat,\n\t\t\t},\n\t\t}).then(result => {\n\t\t\tif (result && result.data && result.data.countrycode) {\n\t\t\t\tconst alpha3code = result.data.countrycode\n\n\t\t\t\tthis.props.globals.convert_alpha3_to_alpha2(alpha3code, (alpha2code)=>{\n\t\t\t\t\tthis.setValue('country',alpha2code)\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tthis.setValue('country',null)\n\t\t\t}\n\t\t}).catch(error=>{\n\t\t\tthis.setValue('country',null)\n\t\t})\n\t}\n\n\tsetValue(formatKey,value){\n\t\tthis.newValue[formatKey] = value\n\t\tthis.publishChanges()\n\t}\n\tpublishChanges(){\n\t\tif (this.props.onChange) {\n\t\t\tlet changedValues = {}\n\t\t\tfor (const key of Object.keys(this.newValue)) {\n\t\t\t\tif (this.state.value[key] !== this.newValue[key]) {\n\t\t\t\t\tchangedValues[key] = this.newValue[key]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.props.onChange(changedValues)\n\t\t}\n\t}\n\n\tgetAddressInputStyles(addressFormat, formatKey) {\n\t\tif (addressFormat.widths[formatKey]) {\n\t\t\treturn {\n\t\t\t\twidth: (addressFormat.widths[formatKey]*100)+'%',\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\twidth: 'auto',\n\t\t\tflexShrink: '2',\n\t\t}\n\t}\n\n\ttoggleShowAllFields(event){\n\t\tthis.setState((state, props) => ({\n\t\t\tshowAllFields: !state.showAllFields\n\t\t}))\n\t}\n\n\trender() {\n\t\tconst countryCode = this.state.value.country || null\n\t\tconst countryCodeLowerCase = (countryCode || '').toLowerCase()\n\t\tconst addressFormat = getAddressFormatByCountryCode(countryCode, this.state.showAllFields)\n\n\t\treturn (<div\n\t\t\tclassName=\"AddressInput\"\n\t\t\tstyle={this.props.style}\n\t\t>\n\n\t\t\t<div>\n\t\t\t{\n\t\t\t\taddressFormat.format.map(row => {\n\t\t\t\t\treturn <div\n\t\t\t\t\t\tkey={JSON.stringify(row)}\n\t\t\t\t\t\tclassName=\"TextFields\"\n\t\t\t\t\t>{\n\t\t\t\t\t\trow.map(formatKey => {\n\t\t\t\t\t\t\tconst value = this.state.value[formatKey]\n\t\t\t\t\t\t\tconst label = this.props.getString(\n\t\t\t\t\t\t\t\t`label_${formatKey}_${countryCodeLowerCase}`, null,\n\t\t\t\t\t\t\t\tthis.props.getString(\n\t\t\t\t\t\t\t\t\t`label_${formatKey}`,null,\n\t\t\t\t\t\t\t\t\tformatKey\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\tclassName=\"TextField\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tkey={formatKey}\n\t\t\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\t\t\ttitle={label}\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\tdefaultValue={value}\n\t\t\t\t\t\t\t\tonChange={event => this.setValue(formatKey,event.target.value)}\n\t\t\t\t\t\t\t\tstyle={this.getAddressInputStyles(addressFormat,formatKey)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})\n\t\t\t\t\t}</div>\n\t\t\t\t})\n\t\t\t}\n\t\t\t</div>\n\n\t\t\t<FormControlLabel\n\t\t\t\tstyle={{\n\t\t\t\t\tdisplay: (countryCode === '_ALL_FIELDS_' ? 'none' : 'flex'),\n\t\t\t\t\tmargin: '8px 0 0',\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t\tpadding: '0 8px 0 0',\n\t\t\t\t\tboxShadow: `inset 0 0 0 999px ${this.props.theme.palette.divider}`,\n\t\t\t\t\tborderRadius: `${this.props.theme.shape.borderRadius}px`,\n\t\t\t\t}}\n\t\t\t\tcontrol={\n\t\t\t\t\t<Switch\n\t\t\t\t\t\tchecked={this.state.showAllFields}\n\t\t\t\t\t\tonChange={this.toggleShowAllFields}\n\t\t\t\t\t\tinputProps={{\n\t\t\t\t\t\t\t'aria-label': this.props.getString('show_all_fields'),\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\tlabel={this.props.getString('show_all_fields')}\n\t\t\t/>\n\n\t\t\t{\n\t\t\t\t!!this.props.helperText\n\t\t\t\t? <Typography className=\"helperText\" variant=\"caption\">{this.props.helperText}</Typography>\n\t\t\t\t: null\n\t\t\t}\n\t\t</div>)\n\n\t\t/*\n\t\tconst dateInputOrder = this.props.getString('date-input-order', null, '').split('-').filter(v=>!!v && v !== ' ') // year-month-day\n\n\t\treturn (<div\n\t\t\tclassName=\"DateInput\"\n\t\t\tstyle={this.props.style}\n\t\t>\n\t\t\t<div className=\"TextFields\">\n\t\t\t\t{\n\t\t\t\t\tdateInputOrder.map((formatKey,index) => (<TextField\n\t\t\t\t\t\tautoFocus={formatKey === 'year'}\n\t\t\t\t\t\tclassName=\"TextField\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tkey={formatKey+'_'+this.state[formatKey]}\n\t\t\t\t\t\tlabel={this.props.getString(`${formatKey}-label`, null, formatKey)}\n\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\tdefaultValue={this.state[formatKey]}\n\t\t\t\t\t\tonChange={event => this.setValue(formatKey,event.target.value)}\n\t\t\t\t\t/>))\n\t\t\t\t}\n\t\t\t</div>\n\n\t\t\t{\n\t\t\t\t!!this.props.helperText\n\t\t\t\t? <Typography className=\"helperText\" variant=\"caption\">{this.props.helperText}</Typography>\n\t\t\t\t: null\n\t\t\t}\n\t\t</div>)\n\t\t*/\n\t}\n}\n\nexport default withGlobals(withLocalization(withTheme(AddressInput)))\n\n\n","import React from 'react'\nimport './index.css'\n\n\n\nimport { Localized, withLocalization } from '../Localized/'\n// import { navigate } from '@reach/router'\n\nimport {\n\tquestions as query_questions,\n\taddChangeset as mutation_addChangeset,\n} from '../../queries.js'\n\n// import categories from '../../data/dist/categories.json'\nimport _presets_ from '../../data/dist/presets.json'\n// import colors from '../../data/dist/colors.json'\n// import colorsByPreset from '../../data/dist/colorsByPreset.json'\nimport { uuidv4, getTranslationFromArray/*, getPreset, getColorByPreset*/ } from '../../functions.js'\n\nimport { withGlobals } from '../Globals/'\n\nimport {\n\tLink,\n\tTypography,\n\tButton,\n\tFab,\n\tPaper,\n\n\tListItem,\n\tListItemIcon,\n\tListItemText,\n\n\tTextField,\n} from '@material-ui/core'\nimport {\n\tDoneRounded as DoneIcon,\n\tArrowBackRounded as ArrowBackIcon,\n\tArrowForwardRounded as ArrowForwardIcon,\n} from '@material-ui/icons'\n// import {\n// \tAutocomplete\n// } from '@material-ui/lab'\nimport { withTheme } from '@material-ui/core/styles'\n\nimport GeoInput from '../GeoInput/'\nimport PresetInput from '../PresetInput/'\nimport DateInput from '../DateInput/'\nimport AudienceInput from '../AudienceInput/'\nimport AddressInput from '../AddressInput/'\n\n\n\n// const nextQuestionIDs_templates = {\n// \timprove: ['start_improve'],\n// \tcreate: ['name','geo_pos','answer_more'],\n// }\n\nclass Questions extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tquestionsAreLoaded: false,\n\t\t\tanswersByQuestionId: {},\n\n\t\t\tquestionsById: {},\n\t\t\tnextQuestionIDs: [], // nextQuestionIDs_templates.create,\n\n\t\t\tstageIndex: 0, // 0=privacy -> 1=questions -> 2=sources -> 3=thanks\n\t\t}\n\n\t\t// this.answerIDs = new Set()\n\t\tthis.sourcesText = ''\n\t\tthis.answer_tags = {}\n\t\tthis.tagsFromTheDoc = {}\n\n\t\tthis.inputValues = {}\n\n\t\tthis.renderStage = this.renderStage.bind(this)\n\n\t\tthis.answerQuestion = this.answerQuestion.bind(this)\n\t\tthis.loadQuestions = this.loadQuestions.bind(this)\n\t\tthis.submitInputs = this.submitInputs.bind(this)\n\n\t\tthis.setQuestionAsActive = this.setQuestionAsActive.bind(this)\n\t\tthis.savePresetValue = this.savePresetValue.bind(this)\n\t\tthis.saveValueByKey = this.saveValueByKey.bind(this)\n\n\t\tthis.abort = this.abort.bind(this)\n\t\tthis.acceptPrivacyPolicy = this.acceptPrivacyPolicy.bind(this)\n\t\tthis.showQuestions = this.showQuestions.bind(this)\n\t\tthis.addSources\t = this.addSources.bind(this)\n\t\tthis.suggest = this.suggest.bind(this)\n\t\tthis.finish = this.finish.bind(this)\n\t\tthis.saveSourcesText = this.saveSourcesText.bind(this)\n\t}\n\n\tcomponentDidMount(){\n\t\t// skip privacy consent screen when already agreed\n\t\tconst privacy_contented_to_tracking = this.props.store.getPrivacy('tracking')\n\t\tif (privacy_contented_to_tracking) {\n\t\t\tthis.setState({stageIndex: 1})\n\t\t}\n\n\t\tthis.setState((state, props) => {\n\t\t\tif (this.state.nextQuestionIDs.length === 0 && this.props.startQuestions.length > 0) {\n\t\t\t\treturn {nextQuestionIDs: this.props.startQuestions}\n\t\t\t}\n\t\t})\n\n\t\tthis.loadQuestions()\n\t}\n\tcomponentDidUpdate(){\n\t\tif (\n\t\t\t!!this.props.doc &&\n\t\t\t// !!this.props.doc._id &&\n\t\t\t!!this.props.doc.properties &&\n\t\t\t!!this.props.doc.properties.tags &&\n\t\t\tthis.props.doc.properties.tags !== this.tagsFromTheDoc\n\t\t) {\n\t\t\tthis.tagsFromTheDoc = this.props.doc.properties.tags\n\t\t}\n\t}\n\tcomponentWillUnmount(){\n\t\tif (!!this.loadQuestionsQuerySubscription) {\n\t\t\tthis.loadQuestionsQuerySubscription.unsubscribe()\n\t\t}\n\t}\n\n\tloadQuestions(){\n\t\tthis.loadQuestionsQuerySubscription = this.props.globals.graphql.watchQuery({\n\t\t\tfetchPolicy: 'cache-and-network',\n\t\t\tquery: query_questions,\n\t\t\tvariables: {\n\t\t\t\tlanguages: navigator.languages,\n\t\t\t},\n\t\t})\n\t\t.subscribe(({data}) => {\n\t\t\tif (!!data && !this.state.questionsAreLoaded) {\n\t\t\t\tconst nextQuestionIDs = [\n\t\t\t\t\t...this.props.startQuestions,\n\t\t\t\t\t...this.state.nextQuestionIDs,\n\t\t\t\t]\n\t\n\t\t\t\tlet firstOpenQuestionCounter = 0\n\t\t\t\tconst questionsById = JSON.parse(JSON.stringify(data.questions)).reduce((obj,questionDoc)=>{\n\t\n\t\t\t\t\tconst hasGeoInputField = questionDoc.properties.possibleAnswers.filter(possibleAnswer => possibleAnswer.inputtype === 'geo').length > 0\n\t\n\t\t\t\t\tif (this.props.globals.isSmallScreen && hasGeoInputField) {\n\t\t\t\t\t\tfirstOpenQuestionCounter += 1\n\t\t\t\t\t}\n\t\n\t\t\t\t\tquestionDoc.properties.question_translated = getTranslationFromArray(questionDoc.properties.question, this.props.globals.userLocales)\n\t\n\t\t\t\t\tquestionDoc.properties.in_one_word_translated = getTranslationFromArray(questionDoc.properties.in_one_word, this.props.globals.userLocales)\n\t\n\t\t\t\t\tquestionDoc.properties.description_translated = getTranslationFromArray(questionDoc.properties.description, this.props.globals.userLocales)\n\t\n\t\t\t\t\tquestionDoc.properties.possibleAnswers = questionDoc.properties.possibleAnswers.map(answer => ({\n\t\t\t\t\t\t...answer,\n\t\t\t\t\t\ttitle_translated: getTranslationFromArray(answer.title, this.props.globals.userLocales),\n\t\t\t\t\t\tdescription_translated: getTranslationFromArray(answer.description, this.props.globals.userLocales),\n\t\t\t\t\t}))\n\t\n\t\t\t\t\tobj[questionDoc._id] = {\n\t\t\t\t\t\t...questionDoc,\n\t\t\t\t\t\t\n\t\t\t\t\t\tvisible: true,\n\t\t\t\t\t\tactive: (questionDoc._id === nextQuestionIDs[firstOpenQuestionCounter]),\n\t\t\t\t\t\tanswered: false,\n\t\n\t\t\t\t\t\tpossibleAnswersByKey: questionDoc.properties.possibleAnswers.reduce((possibleAnswersByKey,possibleAnswer) => {\n\t\t\t\t\t\t\tpossibleAnswersByKey[possibleAnswer.key] = possibleAnswer\n\t\t\t\t\t\t\treturn possibleAnswersByKey\n\t\t\t\t\t\t}, {}),\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn obj\n\t\t\t\t}, {})\n\t\n\t\t\t\tthis.setState({\n\t\t\t\t\tquestionsById,\n\t\t\t\t\tquestionsAreLoaded: true,\n\t\t\t\t}/*, ()=>{\n\t\t\t\t\tthis.setQuestionAsActive(nextQuestionIDs[0])\n\t\t\t\t}*/)\n\t\t\t}\n\t\t})\n\t}\n\n\tsetQuestionAsActive(questionID){\n\t\t// if (Object.keys(this.inputValues).length > 0) {\n\t\t// \tthis.answerQuestion(questionDoc._id, this.inputValues)\n\t\t// }\n\n\t\tthis.setState((state, props) => {\n\t\t\tconst questionIDs = Object.keys(state.questionsById)\n\n\t\t\tlet questionsById = state.questionsById\n\t\t\tfor (const questionID of questionIDs) {\n\t\t\t\tquestionsById[questionID].active = false\n\t\t\t}\n\t\t\t// if (!questionsById[questionID].answered) {\n\t\t\t\tquestionsById[questionID].active = true\n\t\t\t// }\n\n\t\t\treturn {\n\t\t\t\tquestionsById: questionsById,\n\t\t\t}\n\t\t})\n\t}\n\n\tanswer2tags(questionID, answerKey, answerValue, tags = {}){\n\t\tconst question_doc = this.state.questionsById[questionID]\n\n\t\tif (!!question_doc && !!question_doc.possibleAnswersByKey) {\n\t\t\tconst possibleAnswer = question_doc.possibleAnswersByKey[answerKey]\n\n\t\t\tif (!!possibleAnswer) {\n\t\t\t\tif (\n\t\t\t\t\t!!possibleAnswer.tags\n\t\t\t\t\t&& typeof possibleAnswer.tags === \"object\"\n\t\t\t\t\t&& Object.keys(possibleAnswer.tags).length > 0\n\t\t\t\t) {\n\t\t\t\t\tif (typeof answerValue === \"boolean\") {\n\t\t\t\t\t\tif (answerValue === true) {\n\t\t\t\t\t\t\ttags = {\n\t\t\t\t\t\t\t\t...tags,\n\t\t\t\t\t\t\t\t...possibleAnswer.tags,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t// } else if (typeof doc.answerValue === \"object\") {\n\t\t\t\t\t// \tfor (const key in possibleAnswer.tags) {\n\t\t\t\t\t// \t\tif (doc.answerValue[key]) {\n\t\t\t\t\t// \t\t\ttags[key] = doc.answerValue[key]\n\t\t\t\t\t// \t\t}\n\t\t\t\t\t// \t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (const key in possibleAnswer.tags) {\n\t\t\t\t\t\t\ttags[key] = answerValue\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t// add tags from the preset:\n\t\t\t\tif (tags.preset && typeof tags.preset === 'string' && _presets_[tags.preset] && _presets_[tags.preset].tags) {\n\t\t\t\t\ttags = {\n\t\t\t\t\t\t...tags,\n\t\t\t\t\t\t..._presets_[tags.preset].tags,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn tags\n\t}\n\n\tanswerQuestion(questionID, answerValue, followUpQuestionIDs=[]){\n\t\tlet questionGotAnswered = false\n\t\tif (Object.keys(answerValue).length > 0) {\n\t\t\tquestionGotAnswered = true\n\t\t}\n\n\t\tif (questionGotAnswered) {\n\t\t\tthis.answer_tags = {\n\t\t\t\t...this.answer_tags,\n\t\t\t\t...answerValue,\n\t\t\t\t...(Object.entries(answerValue).reduce((tags,entry) => {\n\t\t\t\t\treturn this.answer2tags(questionID, entry[0], entry[1], tags)\n\t\t\t\t}, {}))\n\t\t\t}\n\t\t}\n\n\t\tthis.setState((state, props) => { // start this while mutating\n\t\t\tlet questionsById = state.questionsById\n\t\t\tlet nextQuestionIDs = state.nextQuestionIDs\n\n\t\t\tquestionsById[questionID].active = false\n\t\t\tif (questionGotAnswered) {\n\t\t\t\tquestionsById[questionID].answered = true\n\t\t\t}\n\n\t\t\tif (questionGotAnswered && followUpQuestionIDs.length === 0) {\n\t\t\t\tconst allKeys = Object.keys(answerValue)\n\t\t\t\tfollowUpQuestionIDs = questionsById[questionID].properties.possibleAnswers\n\t\t\t\t.filter(answer => allKeys.includes(answer.key))\n\t\t\t\t.map(answer => answer.followUpQuestionIDs || [])\n\t\t\t\t.reduce((result,followUpQuestionIDs) => {\n\t\t\t\t\treturn [...result, ...followUpQuestionIDs]\n\t\t\t\t}, [])\n\t\t\t}\n\n\t\t\tif (followUpQuestionIDs.length > 0) {\n\t\t\t\tconst currentQuestionPos = nextQuestionIDs.indexOf(questionID)\n\t\t\t\tconst nextQuestionIDs_start_part = nextQuestionIDs.slice(0, currentQuestionPos+1)\n\t\t\t\tconst nextQuestionIDs_end_part = nextQuestionIDs.slice(currentQuestionPos)\n\t\t\t\t\n\t\t\t\tnextQuestionIDs = [...new Set([\n\t\t\t\t\t...nextQuestionIDs_start_part,\n\t\t\t\t\t...followUpQuestionIDs.filter(questionID => !nextQuestionIDs_start_part.includes(questionID)),\n\t\t\t\t\t...nextQuestionIDs_end_part.filter(questionID => !followUpQuestionIDs.includes(questionID))\n\t\t\t\t])]\n\t\t\t}\n\n\t\t\tconst thisIndex = nextQuestionIDs.indexOf(questionID)\n\t\t\tif (thisIndex < nextQuestionIDs.length-1) {\n\t\t\t\tfor (let i=thisIndex+1; i<nextQuestionIDs.length; i+=1) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!!questionsById[nextQuestionIDs[i]]\n\t\t\t\t\t\t&& !questionsById[nextQuestionIDs[i]].answered\n\t\t\t\t\t) {\n\t\t\t\t\t\tquestionsById[nextQuestionIDs[i]].active = true\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (questionGotAnswered) {\n\t\t\t\treturn {\n\t\t\t\t\tnextQuestionIDs,\n\t\t\t\t\tquestionsById,\n\t\t\t\t\tanswersByQuestionId: {\n\t\t\t\t\t\t...state.answersByQuestionId,\n\t\t\t\t\t\t[questionID]: answerValue,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\treturn {\n\t\t\t\t\tnextQuestionIDs,\n\t\t\t\t\tquestionsById,\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tsaveInputValue(questionID, key, value){\n\t\tif (!this.inputValues[questionID]) {\n\t\t\tthis.inputValues[questionID] = {}\n\t\t}\n\t\tthis.inputValues[questionID][key] = value\n\t}\n\tsubmitInputs(questionID){\n\t\tconst tmp_inputValues = this.inputValues[questionID] || {}\n\t\tthis.inputValues[questionID] = {}\n\t\tthis.answerQuestion(questionID, tmp_inputValues)\n\t}\n\tgetInputValueByNamespace(questionID,namespace){\n\t\tlet toReturn = {}\n\t\tconst namespaceWithColon = namespace+':'\n\t\tconst namespaceWithColonLenght = namespaceWithColon.length\n\n\n\t\t// get the unsaved value  \n\t\tif (this.inputValues[questionID]) {\n\t\t\tconst tags = this.inputValues[questionID]\n\t\t\tconst tagKeys = Object.keys(tags)\n\t\t\tfor (const key of tagKeys) {\n\t\t\t\tif (key === namespace) {\n\t\t\t\t\ttoReturn[''] = tags[key]\n\t\t\t\t} else if (key.startsWith(namespaceWithColon)) {\n\t\t\t\t\ttoReturn[key.substring(namespaceWithColonLenght)] = tags[key]\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Object.keys(toReturn).lenght > 0) {\n\t\t\t\treturn toReturn\n\t\t\t}\n\t\t}\n\n\n\t\t// get a value from the documents tags\n\t\tif (this.answer_tags) {\n\t\t\tconst tags = this.answer_tags\n\t\t\tconst tagKeys = Object.keys(tags)\n\t\t\tfor (const key of tagKeys) {\n\t\t\t\tif (key === namespace) {\n\t\t\t\t\ttoReturn[''] = tags[key]\n\t\t\t\t} else if (key.startsWith(namespaceWithColon)) {\n\t\t\t\t\ttoReturn[key.substring(namespaceWithColonLenght)] = tags[key]\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Object.keys(toReturn).lenght > 0) {\n\t\t\t\treturn toReturn\n\t\t\t}\n\t\t}\n\n\n\t\t// get a value from the documents tags\n\t\tif (this.tagsFromTheDoc) {\n\t\t\tconst tags = this.tagsFromTheDoc\n\t\t\tconst tagKeys = Object.keys(tags)\n\t\t\tfor (const key of tagKeys) {\n\t\t\t\tif (key === namespace) {\n\t\t\t\t\ttoReturn[''] = tags[key]\n\t\t\t\t} else if (key.startsWith(namespaceWithColon)) {\n\t\t\t\t\ttoReturn[key.substring(namespaceWithColonLenght)] = tags[key]\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Object.keys(toReturn).lenght > 0) {\n\t\t\t\treturn toReturn\n\t\t\t}\n\t\t}\n\n\n\t\treturn toReturn\n\t}\n\tgetInputValue(questionID,answerKey){\n\n\t\t// get the unsaved value  \n\t\tif (this.inputValues[questionID] && this.inputValues[questionID][answerKey]) {\n\t\t\treturn this.inputValues[questionID][answerKey]\n\t\t}\n\n\t\t// get a value from the given answers\n\t\tconst question_doc = this.state.questionsById[questionID]\n\t\tconst possibleAnswer = question_doc.possibleAnswersByKey[answerKey]\n\t\tconst tagKeys = Object.keys(possibleAnswer.tags || {})\n\n\t\tfor (const key of tagKeys) {\n\t\t\tif (this.answer_tags.hasOwnProperty(key)) {\n\t\t\t\treturn this.answer_tags[key]\n\t\t\t}\n\t\t}\n\n\t\t// get a value from the documents tags\n\t\tfor (const key of tagKeys) {\n\t\t\tif (this.tagsFromTheDoc.hasOwnProperty(key)) {\n\t\t\t\treturn this.tagsFromTheDoc[key]\n\t\t\t}\n\t\t}\n\n\t\treturn ''\n\t}\n\n\tsavePresetValue(questionID,newValue){\n\t\tthis.saveInputValue(questionID, 'preset', newValue.preset)\n\t}\n\tsaveValueByKey(questionID,newValue,namespace){\n\t\tconst keys = Object.keys(newValue)\n\t\tfor (const key of keys) {\n\t\t\tthis.saveInputValue(questionID, (\n\t\t\t\t!!namespace\n\t\t\t\t? (key === '' ? namespace : namespace+':'+key)\n\t\t\t\t: key\n\t\t\t), newValue[key])\n\t\t}\n\t}\n\n\trenderQuestion(questionID){\n\t\tconst questionDoc = this.state.questionsById[questionID]\n\n\t\tif (!(\n\t\t\t!!questionDoc &&\n\t\t\t!!questionDoc._id &&\n\t\t\t!!questionDoc.properties\n\t\t)) {\n\t\t\treturn null\n\t\t}\n\n\t\tif (!questionDoc.visible) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst hasGeoInputField = questionDoc.properties.possibleAnswers.filter(possibleAnswer => possibleAnswer.inputtype === 'geo').length > 0\n\n\t\tif (this.props.globals.isSmallScreen && hasGeoInputField) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst hasInputField = questionDoc.properties.possibleAnswers.filter(possibleAnswer => {\n\t\t\treturn (\n\t\t\t\t   possibleAnswer.inputtype === 'text'\n\t\t\t\t|| possibleAnswer.inputtype === 'number'\n\t\t\t\t|| possibleAnswer.inputtype === 'geo'\n\t\t\t\t|| possibleAnswer.inputtype === 'preset'\n\t\t\t\t|| possibleAnswer.inputtype === 'date'\n\t\t\t\t|| possibleAnswer.inputtype === 'audience'\n\t\t\t\t|| possibleAnswer.inputtype === 'address'\n\t\t\t)\n\t\t}).length > 0\n\n\t\tconst isMultiRow = hasInputField || (questionDoc.properties.possibleAnswers && questionDoc.properties.possibleAnswers.length > 2)\n\n\t\tconst location = this.props.doc.properties.geometry.location\n\n\t\tlet heading = ''\n\t\tif (questionDoc.active) {\n\t\t\tif (questionDoc.properties.question_translated !== '') {\n\t\t\t\theading = questionDoc.properties.question_translated\n\t\t\t} else if (questionDoc.properties.in_one_word_translated !== '') {\n\t\t\t\theading = questionDoc.properties.in_one_word_translated\n\t\t\t}\n\t\t}else{\n\t\t\tif (questionDoc.properties.in_one_word_translated !== '') {\n\t\t\t\theading = questionDoc.properties.in_one_word_translated\n\t\t\t} else if (questionDoc.properties.question_translated !== '') {\n\t\t\t\theading = questionDoc.properties.question_translated\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<Paper\n\t\t\t\tkey={`question_${questionDoc._id}`}\n\t\t\t\tclassName={\n\t\t\t\t\t'questionCard '\n\t\t\t\t\t+(questionDoc.answered ? 'answered ' : '')\n\t\t\t\t\t+(questionDoc.active ? 'active ' : '')\n\t\t\t\t\t+(hasInputField ? 'hasInputField ' : '')\n\t\t\t\t\t+(isMultiRow ? 'isMultiRow ' : '')\n\t\t\t\t}\n\t\t\t\tvariant=\"outlined\"\n\t\t\t\televation={0}\n\t\t\t\tonClick={\n\t\t\t\t\t/*!questionDoc.answered &&*/ !questionDoc.active\n\t\t\t\t\t? ()=>this.setQuestionAsActive(questionDoc._id)\n\t\t\t\t\t: null\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t<ListItem dense disableGutters className=\"questionText\">\n\t\t\t\t\t{\n\t\t\t\t\t\tquestionDoc.properties.icon\n\t\t\t\t\t\t? (\n\t\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"material-icons-round\"\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tcolor: 'inherit',\n\t\t\t\t\t\t\t\t\t\twidth: '40px',\n\t\t\t\t\t\t\t\t\t\theight: '40px',\n\t\t\t\t\t\t\t\t\t\tlineHeight: '40px',\n\t\t\t\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>{questionDoc.properties.icon}</div>\n\t\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: null\n\t\t\t\t\t}\n\t\t\t\t\t<ListItemText\n\t\t\t\t\t\tprimary={heading}\n\t\t\t\t\t\tprimaryTypographyProps={{\n\t\t\t\t\t\t\tvariant: 'body1',\n\t\t\t\t\t\t\t// className: 'questionText',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tsecondary={!questionDoc.active ? '' : questionDoc.properties.description_translated}\n\t\t\t\t\t/>\n\t\t\t\t</ListItem>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"possibleAnswers\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tflexDirection: (isMultiRow ? 'column' : 'row'),\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{\n\t\t\t\t\t\t!questionDoc.active\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: (questionDoc.properties.possibleAnswers.map(possibleAnswer=>{\n\t\t\t\t\t\t\tif (possibleAnswer.hidden) {\n\t\t\t\t\t\t\t\treturn undefined\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tconst possibleAnswerKey = possibleAnswer.key\n\t\t\t\t\t\t\t\tconst possibleAnswerNamespace = possibleAnswer.namespace\n\t\t\t\t\t\t\t\tconst inputtype = possibleAnswer.inputtype || ''\n\t\t\t\t\t\t\t\tconst inputOptions = possibleAnswer.inputOptions || {}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (inputtype === 'date') {\n\t\t\t\t\t\t\t\t\treturn (<DateInput\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tlabel={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\thelperText={possibleAnswer.description_translated}\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.getInputValueByNamespace(questionDoc._id,possibleAnswerNamespace)}\n\t\t\t\t\t\t\t\t\t\tonChange={newValue=>this.saveValueByKey(questionDoc._id, newValue, possibleAnswerNamespace)}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else if (inputtype === 'address') {\n\t\t\t\t\t\t\t\t\treturn (<AddressInput\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tlabel={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\thelperText={possibleAnswer.description_translated}\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.getInputValueByNamespace(questionDoc._id,possibleAnswerNamespace)}\n\t\t\t\t\t\t\t\t\t\ttags={{\n\t\t\t\t\t\t\t\t\t\t\t...this.props.doc.properties.tags,\n\t\t\t\t\t\t\t\t\t\t\t...this.answer_tags,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tonChange={newValue=>this.saveValueByKey(questionDoc._id, newValue, possibleAnswerNamespace)}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tpadding: '0 8px',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else if (inputtype === 'geo') {\n\t\t\t\t\t\t\t\t\treturn (<GeoInput\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tmarker={{\n\t\t\t\t\t\t\t\t\t\t\tcenter: location,\n\t\t\t\t\t\t\t\t\t\t\tzoom: 18,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tdoc={this.props.doc}\n\t\t\t\t\t\t\t\t\t\tonChange={newValue=>this.saveValueByKey(questionDoc._id, newValue, null)}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tmargin: '4px 0',\n\t\t\t\t\t\t\t\t\t\t\tpadding: '0 12px',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else if (inputtype === 'preset') {\n\t\t\t\t\t\t\t\t\treturn (<PresetInput\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tlabel={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.getInputValue(questionDoc._id, possibleAnswerKey)}\n\t\t\t\t\t\t\t\t\t\tonChange={newValue=>this.saveInputValue(questionDoc._id, possibleAnswerKey, newValue)}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tmargin:'8px 8px 4px 8px',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else if (inputtype === 'audience') {\n\t\t\t\t\t\t\t\t\treturn (<AudienceInput\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tlabel={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\thelperText={possibleAnswer.description_translated}\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.getInputValueByNamespace(questionDoc._id,possibleAnswerNamespace)}\n\t\t\t\t\t\t\t\t\t\tonChange={newValue=>this.saveValueByKey(questionDoc._id, newValue, possibleAnswerNamespace)}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tmargin:'0 8px',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else if (inputtype === 'text') {\n\t\t\t\t\t\t\t\t\treturn (<TextField\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t{...(\n\t\t\t\t\t\t\t\t\t\t\tinputOptions.multiline\n\t\t\t\t\t\t\t\t\t\t\t? {multiline: 'multiline'}\n\t\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tlabel={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\thelperText={possibleAnswer.description_translated}\n\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.getInputValue(questionDoc._id, possibleAnswerKey)}\n\t\t\t\t\t\t\t\t\t\tonChange={event=>this.saveInputValue(questionDoc._id, possibleAnswerKey, event.target.value)}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tmargin: '8px 8px 4px',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else if (inputtype === 'number') {\n\t\t\t\t\t\t\t\t\treturn (<TextField\n\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\tlabel={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\thelperText={possibleAnswer.description_translated}\n\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.getInputValue(questionDoc._id, possibleAnswerKey)}\n\t\t\t\t\t\t\t\t\t\tonChange={event=>this.saveInputValue(questionDoc._id, possibleAnswerKey, event.target.value)}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tmargin: '8px 8px 4px',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<ListItem\n\t\t\t\t\t\t\t\t\t\t\tbutton\n\t\t\t\t\t\t\t\t\t\t\tkey={possibleAnswerKey}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.answerQuestion(\n\t\t\t\t\t\t\t\t\t\t\t\tquestionDoc._id,\n\t\t\t\t\t\t\t\t\t\t\t\tpossibleAnswer.tags || {},\n\t\t\t\t\t\t\t\t\t\t\t\tpossibleAnswer.followUpQuestionIDs || [],\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\tflexGrow: '1',\n\t\t\t\t\t\t\t\t\t\t\t\tborder: 'none',\n\t\t\t\t\t\t\t\t\t\t\t\tcolor: 'inherit',\n\t\t\t\t\t\t\t\t\t\t\t\tmargin: '4px 8px',\n\t\t\t\t\t\t\t\t\t\t\t\tpadding: (isMultiRow ? '10px 16px' : '16px 8px'),\n\t\t\t\t\t\t\t\t\t\t\t\tjustifyContent: (isMultiRow ? 'flex-start' : 'center'),\n\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: (isMultiRow ? 'inherit' : 'center'),\n\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: `inset 0 0 0 999px ${this.props.theme.palette.divider}`,\n\t\t\t\t\t\t\t\t\t\t\t\t// boxShadow: `inset 0 0 0 999px ${this.props.theme.palette.background.default}`,\n\t\t\t\t\t\t\t\t\t\t\t\twidth: 'auto',\n\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: `${this.props.theme.shape.borderRadius}px`,\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tisMultiRow && !!possibleAnswer.icon\n\t\t\t\t\t\t\t\t\t\t\t\t? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemIcon style={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tminWidth: '24px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmargin: '6px 16px 0 0',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talignSelf: 'flex-start',\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"material-icons-round\">{possibleAnswer.icon}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t<ListItemText\n\t\t\t\t\t\t\t\t\t\t\t\tprimary={possibleAnswer.title_translated}\n\t\t\t\t\t\t\t\t\t\t\t\tsecondary={possibleAnswer.description_translated}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}))\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\n\t\t\t\t<div className=\"saveButton\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tonClick={()=>this.submitInputs(questionDoc._id)}\n\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tborder: 'none',\n\t\t\t\t\t\t\tboxShadow: `inset 0 0 0 999px ${this.props.theme.palette.divider}`,\n\t\t\t\t\t\t\t// boxShadow: `inset 0 0 0 999px ${this.props.theme.palette.background.default}`,\n\t\t\t\t\t\t\t// boxShadow: 'rgba(0, 0, 0, 0.04) 0px 0px 0px 999px inset',\n\t\t\t\t\t\t\tcolor: 'inherit',\n\t\t\t\t\t\t\tmargin: '0 8px',\n\t\t\t\t\t\t\tpadding: '8px 16px 8px 12px',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DoneIcon style={{color:'var(--light-green)',marginRight:'8px'}}/>\n\t\t\t\t\t\t<Localized id=\"save\" />\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/*<Fab\n\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\tonClick={()=>this.submitInputs(questionDoc._id)}\n\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\tbackground: 'black',\n\t\t\t\t\t\t\tborderRadius: '999px',\n\t\t\t\t\t\t\tpadding: '0 16px 0 20px',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Localized id=\"next\" />\n\t\t\t\t\t\t<ArrowForwardIcon style={{color:'var(--light-green)',marginLeft:'8px'}}/>\n\t\t\t\t\t</Fab>*/}\n\t\t\t\t</div>\n\t\t\t</Paper>\n\t\t)\n\t}\n\n\tabort(){\n\t\tif (this.props.onAbort) {\n\t\t\tthis.props.onAbort()\n\t\t}\n\t}\n\tacceptPrivacyPolicy(){\n\t\tthis.props.store.setPrivacy('tracking', true).finally(()=>{\n\t\t\tthis.props.store.setPrivacy(null, true).finally(()=>{\n\t\t\t\tthis.props.store.set('uuid', uuidv4(), 'tracking')\n\t\t\t\tthis.showQuestions()\n\t\t\t})\n\t\t})\n\t}\n\tshowQuestions(){\n\t\tthis.setState({stageIndex:1})\n\t}\n\taddSources(){\n\t\tthis.setState({stageIndex:2})\n\t}\n\tsuggest(){\n\t\tif (Object.keys(this.answer_tags).length > 0) {\n\t\t\tthis.props.globals.graphql.mutate({\n\t\t\t\tmutation: mutation_addChangeset,\n\t\t\t\tvariables: {\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tforID: this.props.doc._id,\n\t\t\t\t\t\ttags: this.answer_tags,\n\t\t\t\t\t\tsources: this.sourcesText || '',\n\t\t\t\t\t\tfromBot: false,\n\t\t\t\t\t\tdataset: 'qiekub',\n\t\t\t\t\t\tantiSpamUserIdentifier: this.props.store.get('uuid') || '',\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error=>{\n\t\t\t\tconsole.error('mutation_addChangeset-error', error)\n\t\t\t})\n\t\t\t.finally(()=>{\n\t\t\t\tthis.setState({stageIndex:3})\n\t\t\t})\n\t\t}\n\t}\n\tfinish(){\n\t\tif (this.props.onFinish) {\n\t\t\tthis.props.onFinish()\n\t\t}\n\t}\n\n\tsaveSourcesText(event){\n\t\tthis.sourcesText = event.target.value\n\t}\n\n\trenderStage(){\n\t\tconst {stageIndex} = this.state\n\n\t\tif (stageIndex === 0) { // privacy\n\t\t\treturn (<div style={{padding: '16px'}}>\n\t\t\t\t<Typography variant=\"h6\" gutterBottom>\n\t\t\t\t\t<Localized id=\"headings_privacy_stage\" />\n\t\t\t\t</Typography>\n\n\t\t\t\t<Typography variant=\"body1\" gutterBottom>\n\t\t\t\t\t<Localized\n\t\t\t\t\t\tid=\"privacy_info\"\n\t\t\t\t\t\telems={{\n\t\t\t\t\t\t\tprivacy_policy_link: <Link target=\"_blank\" href=\"https://www.qiekub.org/datenschutz.html\"></Link>,\n\t\t\t\t\t\t}}\n\t\t\t\t\t></Localized>\n\t\t\t\t</Typography>\n\t\n\t\t\t\t<div style={{\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\tjustifyContent: 'space-between',\n\t\t\t\t\tmargin: '32px 0 0 0'\n\t\t\t\t}}>\n\t\t\t\t\t<Fab\n\t\t\t\t\t\tonClick={this.abort}\n\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tboxShadow: 'none',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<ArrowBackIcon style={{marginRight:'8px'}}/>\n\t\t\t\t\t\t<Localized id=\"abort\" />\n\t\t\t\t\t</Fab>\n\t\t\t\t\t<Fab\n\t\t\t\t\t\tonClick={this.acceptPrivacyPolicy}\n\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Localized id=\"agree\" />\n\t\t\t\t\t\t<ArrowForwardIcon style={{color:'var(--light-green)',marginLeft:'8px'}}/>\n\t\t\t\t\t</Fab>\n\t\t\t\t</div>\n\t\t\t</div>)\n\t\t} else if (stageIndex === 1) { // questions\n\t\t\tif (!this.state.questionsAreLoaded) {\n\t\t\t\treturn (<div style={{margin:'16px'}}>\n\t\t\t\t\t<Typography variant=\"h6\" gutterBottom>\n\t\t\t\t\t\t<Localized id=\"headings_questions_stage\" />\n\t\t\t\t\t</Typography>\n\n\t\t\t\t\t<Typography variant=\"body1\" style={{margin:'0 0 32px 0'}}>\n\t\t\t\t\t\t<Localized id=\"questions_are_loading\" />\n\t\t\t\t\t</Typography>\n\t\n\t\t\t\t\t<Fab\n\t\t\t\t\t\tonClick={this.abort}\n\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ArrowBackIcon style={{marginRight:'8px'}}/>\n\t\t\t\t\t\t<Localized id=\"abort\" />\n\t\t\t\t\t</Fab>\n\t\t\t\t</div>)\n\t\t\t} else if (!!this.state.questionsById && Object.keys(this.state.questionsById).length > 0) {\n\t\t\t\treturn (<>\n\t\t\t\t\t<Typography variant=\"h6\" gutterBottom style={{margin:'16px 16px 32px 16px'}}>\n\t\t\t\t\t\t<Localized id=\"headings_questions_stage\" />\n\t\t\t\t\t</Typography>\n\n\t\t\t\t\t<React.Fragment key=\"questions\">\n\t\t\t\t\t\t{this.state.nextQuestionIDs.map(questionID => this.renderQuestion(questionID))}\n\t\t\t\t\t</React.Fragment>\n\t\n\t\t\t\t\t<div style={{\n\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\tjustifyContent: 'space-between',\n\t\t\t\t\t\tmargin: '32px 0 0 0'\n\t\t\t\t\t}}>\n\t\t\t\t\t\t<Fab\n\t\t\t\t\t\t\tonClick={this.abort}\n\t\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tboxShadow: 'none',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ArrowBackIcon style={{marginRight:'8px'}}/>\n\t\t\t\t\t\t\t<Localized id=\"abort\" />\n\t\t\t\t\t\t</Fab>\n\t\t\t\t\t\t<Fab\n\t\t\t\t\t\t\tonClick={this.addSources}\n\t\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Localized id=\"next\" />\n\t\t\t\t\t\t\t<ArrowForwardIcon style={{color:'var(--light-green)',marginLeft:'8px'}}/>\n\t\t\t\t\t\t</Fab>\n\t\t\t\t\t</div>\n\t\t\t\t</>)\n\t\t\t}\n\t\t} else if (stageIndex === 2) { // sources\n\t\t\treturn (<div style={{padding: '16px'}}>\n\t\t\t\t<Typography variant=\"h6\" gutterBottom>\n\t\t\t\t\t<Localized id=\"headings_sources_stage\" />\n\t\t\t\t</Typography>\n\n\t\t\t\t<Typography variant=\"body1\" gutterBottom>\n\t\t\t\t\t<Localized id=\"sources_info\" />\n\t\t\t\t</Typography>\n\n\t\t\t\t<TextField\n\t\t\t\t\tstyle={{marginTop: '16px'}}\n\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\tfullWidth\n\t\t\t\t\tmultiline\n\t\t\t\t\tautoFocus={false}\n\t\t\t\t\tplaceholder={this.props.getString('sources_placeholder')}\n\t\t\t\t\tonChange={this.saveSourcesText}\n\t\t\t\t/>\n\t\n\t\t\t\t\t<div style={{\n\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\tjustifyContent: 'space-between',\n\t\t\t\t\t\tmargin: '32px 0 0 0'\n\t\t\t\t\t}}>\n\t\t\t\t\t\t<Fab\n\t\t\t\t\t\t\tonClick={this.showQuestions}\n\t\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tboxShadow: 'none',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ArrowBackIcon style={{marginRight:'8px'}}/>\n\t\t\t\t\t\t\t<Localized id=\"back\" />\n\t\t\t\t\t\t</Fab>\n\t\t\t\t\t\t<Fab\n\t\t\t\t\t\t\tonClick={this.suggest}\n\t\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Localized id=\"suggest\" />\n\t\t\t\t\t\t\t<DoneIcon style={{color:'var(--light-green)',marginLeft:'8px'}}/>\n\t\t\t\t\t\t</Fab>\n\t\t\t\t\t</div>\n\t\t\t</div>)\n\t\t} else if (stageIndex === 3) { // thanks\n\t\t\treturn (<div style={{padding: '16px'}}>\n\t\t\t\t<Typography variant=\"h6\" gutterBottom>\n\t\t\t\t\t<Localized id=\"headings_thanks_stage\" />\n\t\t\t\t</Typography>\n\n\t\t\t\t<Typography variant=\"body1\" gutterBottom>\n\t\t\t\t\t<Localized id=\"after_questions_thanks_text\" />\n\t\t\t\t</Typography>\n\t\n\t\t\t\t\t<div style={{\n\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\tjustifyContent: 'space-between',\n\t\t\t\t\t\tmargin: '32px 0 0 0'\n\t\t\t\t\t}}>\n\t\t\t\t\t\t<Fab\n\t\t\t\t\t\t\tonClick={this.finish}\n\t\t\t\t\t\t\tvariant=\"extended\"\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Localized id=\"finish\" />\n\t\t\t\t\t\t\t<DoneIcon style={{color:'var(--light-green)',marginLeft:'8px'}}/>\n\t\t\t\t\t\t</Fab>\n\t\t\t\t\t</div>\n\t\t\t</div>)\n\t\t}\n\n\t\treturn null\n\t}\n\n\trender() {\n\t\tconst doc = this.props.doc\n\n\t\tif (!(\n\t\t\t!!doc &&\n\t\t\t!!doc._id\n\t\t)) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this.renderStage()\n\t}\n}\n\nexport default withGlobals(withLocalization(withTheme(Questions)))\n\n"],"sourceRoot":""}